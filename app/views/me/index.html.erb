<h2 class="text-2xl font-bold mb-4">
  わたしのスケジュール
</h2>
<%= form_with(url: schedules_path, method: :post, data: { turbo: false }, class: "mb-16") do |f| %>
  <% @dates.each do |date| %>
    <div class="mb-4">
      <div class="flex justify-center items-center space-x-4 mb-2">
        <span class="text-xl font-bold"><%= mdw(date) %></span>
        <% Schedule.slots.keys.each do |slot| %>
          <% schedule = current_member.schedules.find_or_initialize_by(date: date, slot: slot) %>
          <% status_selected = schedule.new_record? ? nil : schedule.status_before_type_cast %>
          <span><%= slot %></span>
          <%= hidden_field_tag("schedules[][date]", date) %>
          <%= hidden_field_tag("schedules[][slot]", slot) %>
          <%= hidden_field_tag("schedules[][status]", status_selected, id: "#{date}-#{slot}-status") %>
          <span class="status-selection">
            <%= image_tag("status-ok.png", size: 32, data: { status: 0, date: date.to_s, slot: slot }, class: "inline-block cursor-pointer #{'selected' if status_selected == 0}") %>
            <%= image_tag("status-ng.png", size: 32, data: { status: 2, date: date.to_s, slot: slot }, class: "inline-block cursor-pointer #{'selected' if status_selected == 2}") %>
          </span>
          <div>
            <%= text_field_tag("schedules[][memo]", schedule.memo, placeholder: "メモ", class: "w-full border-none") %>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
  <%= f.submit("入力を保存する", class: "fixed bottom-4 right-4 bg-rose-500 text-white px-4 py-2 rounded-md cursor-pointer") %>
<% end %>
